function ri(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();async function T(e){const t=await fetch(e);if(!t.ok)throw new Error("Failed to load ".concat(e));return await t.text()}const Le="https://gfoh.ddns.net:6969/api";window.port=6969;async function Se(e){var t,n,s;try{const o=await fetch("".concat(Le).concat(e));if(!o.ok)throw new Error("❌❌❌❌Fehler beim Abrufen von ".concat(e,": ").concat(o.statusText));const i=await o.json();return console.log("✅✅✅✅ ERFOLGREICH GELADEN!"+e),i}catch(o){return console.error(o),(t=o==null?void 0:o.message)!=null&&t.includes("503")||(n=o==null?void 0:o.message)!=null&&n.includes("Failed to fetch")||(s=o==null?void 0:o.message)!=null&&s.includes("Service Unavailable")?(await new Promise(i=>setTimeout(i,1e3)),console.log("❌❌❌❌ Retrying fetch for "+e+" due to 503... ❌❌❌❌"),await Se(e)):null}}async function C(e,t){var n,s,o;try{console.log("[fetchDataWithToken] ➜ Endpoint: ".concat(e,", Token:"),t);const i=await fetch("".concat(Le).concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});if(console.log("[fetchDataWithToken] ⇐ Status: ".concat(i.status)),i.status===403)throw console.log("403"),new Error("Token abgelaufen oder ungültig (403 Forbidden)");if(!i.ok)throw console.log("other error"),new Error("Fehler beim Abrufen von ".concat(e,": ").concat(i.statusText));const r=await i.json();return console.log("[fetchDataWithToken] ✅ Erfolgreich geladen:",r),console.log("✅✅✅✅ ERFOLGREICH GELADEN!"+e),r}catch(i){return console.error(i),(n=i==null?void 0:i.message)!=null&&n.includes("503")||(s=i==null?void 0:i.message)!=null&&s.includes("Failed to fetch")||(o=i==null?void 0:i.message)!=null&&o.includes("Service Unavailable")?(await new Promise(r=>setTimeout(r,1e3)),console.log("❌❌❌❌ Retrying fetch for "+e+" due to 503... ❌❌❌❌"),await C(e,t)):null}}async function b(e,t,n){var s,o,i;try{console.log(t);const r=await fetch("".concat(Le).concat(e),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(t)});if(!r.ok)throw new Error("Fehler beim Senden von ".concat(e,": ").concat(r.statusText));const a=await r.json();return console.log("✅✅✅✅ ERFOLGREICH GELADEN!"+e),a}catch(r){return console.error(r),(s=r==null?void 0:r.message)!=null&&s.includes("503")||(o=r==null?void 0:r.message)!=null&&o.includes("Failed to fetch")||(i=r==null?void 0:r.message)!=null&&i.includes("Service Unavailable")?(await new Promise(a=>setTimeout(a,1e3)),console.log("❌❌❌❌ Retrying fetch for "+e+" due to 503... ❌❌❌❌"),console.log(t),await b(e,t,n)):null}}function Wt(e){try{const t=e.split(".")[1],n=atob(t);return JSON.parse(n)}catch(t){return null}}function v(){const e=localStorage.getItem("token");if(!e)throw new Error("Token nicht gefunden");return e}function D(){const e=v();return Wt(e)}function Xe(){localStorage.removeItem("token"),localStorage.removeItem("userData"),alert("Your session has expired. You are being logged out."),window.location.href="./html-pages/unauthorized.html"}async function Gt(e){try{const t=D();(!t||!e.includes(t.role))&&Kt()}catch(t){console.warn("Access denied because no token was found. Redirecting..."),Vt()}}function Vt(){window.location.href="./set-up/pages/getstarted.html"}async function Kt(){const e=document.getElementsByTagName("body")[0];e.innerHTML="!! ACCESS DENIED !!",await new Promise(t=>setTimeout(t,1)),alert("No access to this page."),window.location.href="./html-pages/unauthorized.html"}function z(e){const t=D();if(t)return t.role===e}async function Oe(){const e=localStorage.getItem("token");if(!e)return console.log("[checkSessionTokenValid] Kein Token gefunden"),!1;try{const t=await C("/check-token",e);return console.log("[checkSessionTokenValid] ✅ Token gültig"),!0}catch(t){return t.message.includes("403")?(console.warn("[checkSessionTokenValid] ❌ Token abgelaufen – Nutzer wird ausgeloggt"),Xe(),!1):(console.warn("[checkSessionTokenValid] ⚠️ Server nicht erreichbar – Tokenstatus unbekannt, Nutzer bleibt eingeloggt"),!0)}}async function zt(){return await Se("/dishes")}async function Yt(){return await Se("/ingredients")}async function Xt(){return await C("/users",v())}async function Ue(e="all"){const t=v();return await b("/dishes_full_filtered",{category:e},t)}async function Jt(e){const n=(await C("/users",v())).find(s=>s.email===e);if(!n)throw new Error("Benutzer nicht gefunden");return n.user_id}async function Zt(e,t){try{const n=await Jt(t),s=v(),i=await b("/set-role",{userId:n,role:e},s);return alert("Rolle erfolgreich geändert!"),i}catch(n){alert("Fehler beim Rollenwechsel: "+n.message)}}async function Qt(e){try{const t=v();return await b("/delete-user",{userID:e},t)}catch(t){return alert("Failed to delete user: "+t.message),!1}}async function en(e){try{const t=v();return await b("/add-dish",e,t)}catch(t){alert("Failed to add new dish: "+t.message)}}async function tn(e){try{const t=v();return await b("/add-ingredient",e,t)}catch(t){alert("Failed to add new ingredient: "+t.message)}}async function nn(e){try{const t=v();return await b("/delete-dish",{dishID:e},t)}catch(t){alert("Failed to delete dish: "+t.message)}}async function sn(e){try{const t=v();return await b("/delete-ingredient",{ingredientID:e},t)}catch(t){alert("Failed to delete ingredient: "+t.message)}}function Je(e){const t=D();b("/add-week-plan",{weekPlan:e,userId:t.id},v())}async function on(){const e=v();return await C("/get-week-plan",e)}async function rn(){const e=v();return await C("/get-ingredients-from-week-plan",e)}function an(){try{const e=localStorage.getItem("userData");return e?JSON.parse(e):{}}catch(e){return console.error("Error reading user data:",e),{}}}async function Ze(e){const t=v();if(!t||!e)throw new Error("Token or UserInfo is missing");await b("/save-user-data",e,t)}async function Qe(){const e=v();return await C("/get-user-data",e)}async function cn(){var n,s,o,i;const e=an();if(!e.gender||!e.age||!e.weight||!e.height||!e.activityLevel||!e.goal){console.warn("No user data found in local storage. Skipping initial save.");return}console.warn("Saving initial user data to DB...");const t={gender:e.gender,age:e.age,weight_kg:(n=e.weight)==null?void 0:n.kg,weight_pounds:(s=e.weight)==null?void 0:s.pounds,height_cm:(o=e.height)==null?void 0:o.cm,height_feet_and_inches:(i=e.height)==null?void 0:i.feetAndInches,activityLevel:e.activityLevel,goal:e.goal};try{await Ze(t),localStorage.removeItem("userData")}catch(r){console.error("Failed to save initial user data to DB:",r)}}async function oe(e){const t=v();if(console.log("Data being sent to save-next-meals:",e),!t||!e)throw new Error("Token or UserInfo is missing");await b("/save-next-meals",{next_meals:e},t)}async function ln(){const e=v();return await C("/get-next-meals",e)}async function dn(e){const t=v();if(!t||!Array.isArray(e)||e.length===0)throw new Error("Token or items list is missing or empty");await b("/set-user-list-items",{items:e},t)}async function un(){const e=v();return await C("/get-user-list-items",e)}async function mn(e){const t=v();if(!t||!e)throw new Error("Token or item is missing");await b("/add-user-list-item",e,t)}async function fn(e){const t=v();if(!t||!e)throw new Error("Token or identifier is missing");await b("/delete-user-list-item",{identifier:e},t)}async function Ce(e,t){const n=v();if(!n||!e||!t)throw new Error("Token, identifier or updatedItem is missing");await b("/update-user-list-item",{identifier:e,updatedItem:t},n)}async function gn(){const e=v();return await b("/delete-old-and-create-new-list",{},e)}async function Z(e,t,n){const s=v();if(!s||!t||!["like","dislike","neutral"].includes(n)||!["dish","ingredient"].includes(e))throw new Error("Invalid input");await b("/set-user-preference",{type:e,id:t,preference:n},s)}async function et(){const e=v();if(!e)throw new Error("Token missing");return await C("/get-user-preferences",e)}function H(e,t,n){let s=!1,o=!1,i=0,r=0,a=0,l=null,d=null,c=null,m=!1;const g=500,E=90,h=30,f=()=>{m=!0,setTimeout(()=>{m=!1},g)},y=async u=>{u&&(u.style.maxHeight="".concat(u.offsetHeight,"px"),requestAnimationFrame(()=>{u.classList.add("deleting")}),u.addEventListener("transitionend",async()=>{let p=u.querySelector(".item-id");if(u.remove(),p){let w=parseInt(p.textContent,10);w?await n(w):await n(p.textContent)}},{once:!0}))},x=u=>{e.querySelectorAll(t).forEach(p=>{if(p!==u){const w=p.querySelector(".swipe-content"),k=p.querySelector(".swipe-delete");w&&(w.style.transform="translateX(0)",w.style.borderRadius="0px"),k&&(k.style.width="0px",k.style.opacity="0")}})},G=u=>{if(!c||!o)return;const p=Math.abs(u);p>0?(c.style.width="".concat(p,"px"),c.style.opacity="1"):(c.style.width="0px",c.style.opacity="0")},A=u=>{if(m)return;const p=u.target.closest(t);!p||u.target.closest("button")||u.target.closest("object")||u.target.classList.contains("swipe-delete")||(x(p),s=!0,o=!1,l=p,d=p.querySelector(".swipe-content"),c=p.querySelector(".swipe-delete"),i=u.type.includes("mouse")?u.pageX:u.touches[0].pageX,r=u.type.includes("mouse")?u.pageY:u.touches[0].pageY,a=i)},M=u=>{if(!s||!d)return;a=u.type.includes("mouse")?u.pageX:u.touches[0].pageX;const p=u.type.includes("mouse")?u.pageY:u.touches[0].pageY;let w=a-i,k=Math.abs(p-r);if(!o){if(k>h){s=!1;return}if(w<-20)o=!0,c&&(c.style.width="0px",c.style.opacity="0",c.style.transition="none"),d&&(d.style.transition="none");else return}o&&w<=0&&(d.style.transform="translateX(".concat(w,"px)"),G(w))},$=()=>{if(!s||!d)return;if(s=!1,!o){o=!1;return}let u=a-i;d.style.transition="transform 0.3s ease-out, border-radius 0.3s ease-out",c&&(c.style.transition="width 0.3s ease-out, opacity 0.3s ease-out"),u<-150?(f(),d.style.transform="translateX(-100%)",d.style.borderRadius="0 0 0 0",c&&(c.style.width="100%",c.style.opacity="1"),d.addEventListener("transitionend",()=>y(l),{once:!0})):u<-30?(d.style.transform="translateX(-".concat(E,"px)"),d.style.borderRadius="0 0 0 0",c&&(c.style.width="".concat(E,"px"),c.style.opacity="1")):(d.style.transform="translateX(0)",d.style.borderRadius="0px",c&&(c.style.width="0px",c.style.opacity="0")),o=!1},ue=u=>{if(!m&&u.target.classList.contains("swipe-delete")){const p=u.target.closest(t);f(),y(p)}},O=u=>{const p=e.querySelectorAll(t);let w=u.target.closest(t);p.forEach(k=>{const I=k.querySelector(".swipe-content"),L=k.querySelector(".swipe-delete");I&&I.style.transform&&I.style.transform!=="translateX(0px)"&&I.style.transform!==""&&k!==w&&(I.style.transition="transform 0.3s ease-out, border-radius 0.3s ease-out",I.style.transform="translateX(0)",I.style.borderRadius="0px",L&&(L.style.transition="width 0.3s ease-out, opacity 0.3s ease-out",L.style.width="0px",L.style.opacity="0"))})};e.addEventListener("mousedown",A),document.addEventListener("mousemove",M),document.addEventListener("mouseup",$),e.addEventListener("touchstart",A,{passive:!0}),document.addEventListener("touchmove",M,{passive:!0}),document.addEventListener("touchend",$),e.addEventListener("click",ue),document.addEventListener("click",O)}class Q{constructor(t,n=null){this.element=t,this.trigger=t.querySelector(".select-trigger"),this.dropdown=t.querySelector(".select-dropdown"),this.options=t.querySelectorAll(".select-option"),this.selectedText=t.querySelector(".select-text"),this.arrow=t.querySelector(".select-arrow"),this.isOpen=!1,this.selectedValue=null,this.onChangeCallback=n,this.init()}init(){this.trigger.addEventListener("click",t=>{t.stopPropagation(),this.toggle()}),this.options.forEach(t=>{t.addEventListener("click",n=>{console.log("Option clicked:",t.textContent),n.stopPropagation(),this.selectOption(t)})}),document.addEventListener("click",t=>{!this.element.contains(t.target)&&this.isOpen&&this.close()}),this.element.addEventListener("keydown",t=>{this.handleKeyPress(t)}),this.initializeDefault(),this.trigger.setAttribute("tabindex","0"),this.options.forEach(t=>{t.addEventListener("touchstart",n=>{t.classList.add("touching")}),t.addEventListener("touchend",n=>{t.classList.remove("touching")})})}initializeDefault(){const t=this.element.querySelector(".select-option.selected");if(t){this.selectedText.textContent=t.textContent,this.selectedValue=t.dataset.value;return}const n=this.options[0];n&&this.selectOption(n)}toggle(){console.log("Toggle called, isOpen:",this.isOpen),this.isOpen?this.close():this.open()}open(){console.log("Opening dropdown");const t=this.selectedText.textContent.trim().toLowerCase();t&&this.options.forEach(n=>{n.textContent.trim().toLowerCase()===t?n.classList.contains("selected")||(n.classList.add("selected"),this.selectedValue=n.dataset.value):n.classList.remove("selected")}),this.isOpen=!0,this.trigger.classList.add("active"),this.dropdown.classList.add("active"),this.trigger.setAttribute("aria-expanded","true")}close(){console.log("Closing dropdown"),this.isOpen=!1,this.trigger.classList.remove("active"),this.dropdown.classList.remove("active"),this.trigger.setAttribute("aria-expanded","false")}selectOption(t){this.options.forEach(s=>s.classList.remove("selected")),t.classList.add("selected"),this.selectedText.textContent=t.textContent,this.selectedValue=t.dataset.value,this.close(),this.onChangeCallback&&this.onChangeCallback(this.selectedValue,t.textContent);const n=new CustomEvent("change",{detail:{value:this.selectedValue,text:t.textContent}});this.element.dispatchEvent(n)}handleKeyPress(t){switch(t.key){case"Enter":case" ":t.preventDefault(),this.isOpen||this.open();break;case"Escape":this.close();break;case"ArrowDown":t.preventDefault(),this.navigateOptions(1);break;case"ArrowUp":t.preventDefault(),this.navigateOptions(-1);break}}navigateOptions(t){if(!this.isOpen){this.open();return}let s=Array.from(this.options).findIndex(o=>o.classList.contains("selected"))+t;s<0&&(s=this.options.length-1),s>=this.options.length&&(s=0),this.selectOption(this.options[s])}getValue(){return this.selectedValue}setValue(t){const n=Array.from(this.options).find(s=>s.dataset.value===t);n&&this.selectOption(n)}}function hn(){document.querySelectorAll(".custom-select").forEach(t=>{new Q(t)})}function ee(e,t){const n=document.getElementById(e);n&&t&&n.addEventListener("input",()=>{const s=n.value.toLowerCase();t.forEach(o=>{document.querySelectorAll("".concat(o," li")).forEach(i=>{i.style.display=i.textContent.toLowerCase().includes(s)?"":"none"})})})}const pn="modulepreload",yn=function(e,t){return new URL(e,t).href},Ne={},vn=function(t,n,s){let o=Promise.resolve();if(n&&n.length>0){let d=function(c){return Promise.all(c.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};const r=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=d(n.map(c=>{if(c=yn(c,s),c in Ne)return;Ne[c]=!0;const m=c.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(!!s)for(let f=r.length-1;f>=0;f--){const y=r[f];if(y.href===c&&(!m||y.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(c,'"]').concat(g)))return;const h=document.createElement("link");if(h.rel=m?"stylesheet":pn,m||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),m)return new Promise((f,y)=>{h.addEventListener("load",f),h.addEventListener("error",()=>y(new Error("Unable to preload CSS for ".concat(c))))})}))}function i(r){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r}return o.then(r=>{for(const a of r||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})};/*! Capacitor: https://capacitorjs.com/ - MIT License */var q;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(q||(q={}));class me extends Error{constructor(t,n,s){super(t),this.message=t,this.code=n,this.data=s}}const wn=e=>{var t,n;return e!=null&&e.androidBridge?"android":!((n=(t=e==null?void 0:e.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},En=e=>{const t=e.CapacitorCustomPlatform||null,n=e.Capacitor||{},s=n.Plugins=n.Plugins||{},o=()=>t!==null?t.name:wn(e),i=()=>o()!=="web",r=m=>{const g=d.get(m);return!!(g!=null&&g.platforms.has(o())||a(m))},a=m=>{var g;return(g=n.PluginHeaders)===null||g===void 0?void 0:g.find(E=>E.name===m)},l=m=>e.console.error(m),d=new Map,c=(m,g={})=>{const E=d.get(m);if(E)return console.warn('Capacitor plugin "'.concat(m,'" already registered. Cannot register plugins twice.')),E.proxy;const h=o(),f=a(m);let y;const x=async()=>(!y&&h in g?y=typeof g[h]=="function"?y=await g[h]():y=g[h]:t!==null&&!y&&"web"in g&&(y=typeof g.web=="function"?y=await g.web():y=g.web),y),G=(u,p)=>{var w,k;if(f){const I=f==null?void 0:f.methods.find(L=>p===L.name);if(I)return I.rtype==="promise"?L=>n.nativePromise(m,p.toString(),L):(L,V)=>n.nativeCallback(m,p.toString(),L,V);if(u)return(w=u[p])===null||w===void 0?void 0:w.bind(u)}else{if(u)return(k=u[p])===null||k===void 0?void 0:k.bind(u);throw new me('"'.concat(m,'" plugin is not implemented on ').concat(h),q.Unimplemented)}},A=u=>{let p;const w=(...k)=>{const I=x().then(L=>{const V=G(L,u);if(V){const K=V(...k);return p=K==null?void 0:K.remove,K}else throw new me('"'.concat(m,".").concat(u,'()" is not implemented on ').concat(h),q.Unimplemented)});return u==="addListener"&&(I.remove=async()=>p()),I};return w.toString=()=>"".concat(u.toString(),"() { [capacitor code] }"),Object.defineProperty(w,"name",{value:u,writable:!1,configurable:!1}),w},M=A("addListener"),$=A("removeListener"),ue=(u,p)=>{const w=M({eventName:u},p),k=async()=>{const L=await w;$({eventName:u,callbackId:L},p)},I=new Promise(L=>w.then(()=>L({remove:k})));return I.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await k()},I},O=new Proxy({},{get(u,p){switch(p){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return f?ue:M;case"removeListener":return $;default:return A(p)}}});return s[m]=O,d.set(m,{name:m,proxy:O,platforms:new Set([...Object.keys(g),...f?[h]:[]])}),O};return n.convertFileSrc||(n.convertFileSrc=m=>m),n.getPlatform=o,n.handleError=l,n.isNativePlatform=i,n.isPluginAvailable=r,n.registerPlugin=c,n.Exception=me,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},kn=e=>e.Capacitor=En(e),te=kn(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),ie=te.registerPlugin;class tt{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,n){let s=!1;this.listeners[t]||(this.listeners[t]=[],s=!0),this.listeners[t].push(n);const i=this.windowListeners[t];i&&!i.registered&&this.addWindowListener(i),s&&this.sendRetainedArgumentsForEvent(t);const r=async()=>this.removeListener(t,n);return Promise.resolve({remove:r})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,n,s){const o=this.listeners[t];if(!o){if(s){let i=this.retainedEventArguments[t];i||(i=[]),i.push(n),this.retainedEventArguments[t]=i}return}o.forEach(i=>i(n))}hasListeners(t){var n;return!!(!((n=this.listeners[t])===null||n===void 0)&&n.length)}registerWindowListener(t,n){this.windowListeners[n]={registered:!1,windowEventName:t,pluginEventName:n,handler:s=>{this.notifyListeners(n,s)}}}unimplemented(t="not implemented"){return new te.Exception(t,q.Unimplemented)}unavailable(t="not available"){return new te.Exception(t,q.Unavailable)}async removeListener(t,n){const s=this.listeners[t];if(!s)return;const o=s.indexOf(n);this.listeners[t].splice(o,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const n=this.retainedEventArguments[t];n&&(delete this.retainedEventArguments[t],n.forEach(s=>{this.notifyListeners(t,s)}))}}const Fe=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),He=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class bn extends tt{async getCookies(){const t=document.cookie,n={};return t.split(";").forEach(s=>{if(s.length<=0)return;let[o,i]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");o=He(o).trim(),i=He(i).trim(),n[o]=i}),n}async setCookie(t){try{const n=Fe(t.key),s=Fe(t.value),o="; expires=".concat((t.expires||"").replace("expires=","")),i=(t.path||"/").replace("path=",""),r=t.url!=null&&t.url.length>0?"domain=".concat(t.url):"";document.cookie="".concat(n,"=").concat(s||"").concat(o,"; path=").concat(i,"; ").concat(r,";")}catch(n){return Promise.reject(n)}}async deleteCookie(t){try{document.cookie="".concat(t.key,"=; Max-Age=0")}catch(n){return Promise.reject(n)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const n of t)document.cookie=n.replace(/^ +/,"").replace(/=.*/,"=;expires=".concat(new Date().toUTCString(),";path=/"))}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}ie("CapacitorCookies",{web:()=>new bn});const In=async e=>new Promise((t,n)=>{const s=new FileReader;s.onload=()=>{const o=s.result;t(o.indexOf(",")>=0?o.split(",")[1]:o)},s.onerror=o=>n(o),s.readAsDataURL(e)}),Ln=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(o=>o.toLocaleLowerCase()).reduce((o,i,r)=>(o[i]=e[t[r]],o),{})},Sn=(e,t=!0)=>e?Object.entries(e).reduce((s,o)=>{const[i,r]=o;let a,l;return Array.isArray(r)?(l="",r.forEach(d=>{a=t?encodeURIComponent(d):d,l+="".concat(i,"=").concat(a,"&")}),l.slice(0,-1)):(a=t?encodeURIComponent(r):r,l="".concat(i,"=").concat(a)),"".concat(s,"&").concat(l)},"").substr(1):null,Cn=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),o=Ln(e.headers)["content-type"]||"";if(typeof e.data=="string")n.body=e.data;else if(o.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[r,a]of Object.entries(e.data||{}))i.set(r,a);n.body=i.toString()}else if(o.includes("multipart/form-data")||e.data instanceof FormData){const i=new FormData;if(e.data instanceof FormData)e.data.forEach((a,l)=>{i.append(l,a)});else for(const a of Object.keys(e.data))i.append(a,e.data[a]);n.body=i;const r=new Headers(n.headers);r.delete("content-type"),n.headers=r}else(o.includes("application/json")||typeof e.data=="object")&&(n.body=JSON.stringify(e.data));return n};class xn extends tt{async request(t){const n=Cn(t,t.webFetchExtra),s=Sn(t.params,t.shouldEncodeUrlParams),o=s?"".concat(t.url,"?").concat(s):t.url,i=await fetch(o,n),r=i.headers.get("content-type")||"";let{responseType:a="text"}=i.ok?t:{};r.includes("application/json")&&(a="json");let l,d;switch(a){case"arraybuffer":case"blob":d=await i.blob(),l=await In(d);break;case"json":l=await i.json();break;case"document":case"text":default:l=await i.text()}const c={};return i.headers.forEach((m,g)=>{c[g]=m}),{data:l,headers:c,status:i.status,url:i.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}ie("CapacitorHttp",{web:()=>new xn});var Re;(function(e){e.Heavy="HEAVY",e.Medium="MEDIUM",e.Light="LIGHT"})(Re||(Re={}));var je;(function(e){e.Success="SUCCESS",e.Warning="WARNING",e.Error="ERROR"})(je||(je={}));const Bn=ie("Haptics",{web:()=>vn(()=>import("./web-DoHXbUFe.js"),[],import.meta.url).then(e=>new e.HapticsWeb)});var We;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(We||(We={}));var Ge;(function(e){e.None="NONE",e.Slide="SLIDE",e.Fade="FADE"})(Ge||(Ge={}));ie("StatusBar");const re=te.isNativePlatform();async function Dn(){if(!re){console.log("Haptics: Vibrate requested, but platform is not native.");return}await Bn.vibrate()}function R(e){re&&e.classList.add("nativeContainer")}function ae(){re&&document.getElementById("app").classList.add("nativeApp")}function _n(){re&&document.getElementById("app").classList.remove("nativeApp")}async function Tn(){const e=document.getElementById("app"),t=await T("./html-pages/settings.html");e.innerHTML=t,R(document.querySelector(".settings-container")),_n(),$n(),le(),xe(),Mn(),await An()}function nt(e){return e.toString().replace(",",".")}async function An(){const{gender:e,age:t,weight_kg:n,weight_pounds:s,height_cm:o,height_feet_and_inches:i,activityLevel:r,goal:a}=await Qe(),l=document.getElementById("height-st"),d=document.getElementById("weight-st"),c=document.getElementById("age-st"),m=document.getElementById("sex-st");l.value=o,d.value=nt(n.toFixed(1)),c.value=t,l.placeholder="cm",d.placeholder="kg",c.placeholder="years",e?m.textContent=e.toLowerCase():m.textContent="",document.querySelectorAll("#activity-container .card-st-activity").forEach(h=>{h.querySelector(".al-text-st").textContent===r?h.classList.add("clicked-st-activity"):h.classList.remove("clicked-st-activity")}),document.querySelectorAll("#goal-container .card-st-goal").forEach(h=>{h.querySelector(".al-text-st").textContent===a?h.classList.add("clicked-st-goal"):h.classList.remove("clicked-st-goal")})}function Pn(){const e=document.getElementById("height-st"),t=document.getElementById("weight-st"),n=document.getElementById("age-st"),s=document.getElementById("sex-st"),o=parseFloat(e.value),i=parseFloat(nt(t.value)),r=parseInt(n.value,10),a=s.textContent,l=(i*2.20462).toFixed(1),d=o/2.54,c=Math.floor(d/12),m=Math.round(d%12),g="".concat(c,"' ").concat(m,'"'),E=document.querySelector("#activity-container .clicked-st-activity .al-text-st"),h=E?E.textContent:null,f=document.querySelector("#goal-container .clicked-st-goal .al-text-st"),y=f?f.textContent:null;Ze({gender:a,age:r,weight_kg:i,weight_pounds:l,height_cm:o,height_feet_and_inches:g,activityLevel:h,goal:y})}function xe(){const e=localStorage.getItem("theme")||"light";document.body.classList.toggle("dark-mode",e==="dark")}function qn(){const e=localStorage.getItem("theme")||"light",t=document.querySelector(".custom-select.sex-field");new Q(t).setValue();const s=document.querySelector(".custom-select.theme-field");new Q(s,i=>{const r=i;localStorage.setItem("theme",r),document.body.classList.toggle("dark-mode",r==="dark")}).setValue(e)}function Mn(){qn();const e=document.getElementById("weight-st");e.addEventListener("keypress",o=>{const i=e.value,r=/^[0-9]*([.,][0-9]*)?$/,a=i+o.key;r.test(a)||o.preventDefault()});const t=document.querySelector(".bigger-hitbox-st");t&&t.addEventListener("click",On);const n=document.querySelectorAll(".card-st-activity");n.forEach(o=>{o.addEventListener("click",function(){n.forEach(i=>i.classList.remove("clicked-st-activity")),this.classList.add("clicked-st-activity")})});const s=document.querySelectorAll(".card-st-goal");s.forEach(o=>{o.addEventListener("click",function(){s.forEach(i=>i.classList.remove("clicked-st-goal")),this.classList.add("clicked-st-goal")})}),document.getElementById("logout-btn").addEventListener("click",Xe)}function ce(){const e=document.querySelector(".settings");e&&e.addEventListener("click",function(){window.location.href="#settings"})}function $n(){const e=document.getElementById("main-nav");e&&(e.classList.add("hiddenNav"),e.classList.remove("showNav"))}function Ve(){const e=oi();window.location.href=e}function On(){if(!Un()){Ve();return}console.log("Settings saved!"),Pn(),Ve()}function Un(){const e=document.getElementById("height-st").value.trim(),t=document.getElementById("weight-st").value.trim(),n=document.getElementById("age-st").value.trim(),s=document.getElementById("sex-st").textContent.trim();return e&&t&&n&&s}let B,st;async function Nn(){Dn(),B=await Yt(),st=await zt(),W();const e=document.getElementById("app"),t=await T("./html-pages/meals.html");e.innerHTML=t,R(document.querySelector(".meals-container")),ae(),xe(),fs(),le(),Vn(),gs(),ce(),Fn(),hn(),Hn(),Rn(),jn(),Gn();const n=await et();console.warn("Preferences loaded:",n),Yn(n),es()}function Fn(){document.querySelectorAll("#filter-bar-p button").forEach(t=>{t.addEventListener("click",()=>{document.querySelector("#food-p").scrollTop=0,Kn(t)})})}function Hn(){document.querySelectorAll(".like").forEach(n=>{n.addEventListener("click",Be)}),document.querySelectorAll(".dislike").forEach(n=>{n.addEventListener("click",De)})}function Rn(){ee("search-preferences",["#dishes-list-p","#ingredients-list-p"]),ee("search-ingredients",["#ingredientsContainer"])}function jn(){document.getElementById("add-meal-p").addEventListener("click",function(e){os(),$e()}),document.getElementById("closeMealBtn").addEventListener("click",function(e){U(),S()}),document.getElementById("addBtn-p").addEventListener("click",as),document.getElementById("addTagBtn").addEventListener("click",fe),document.getElementById("tagInput").addEventListener("keypress",function(e){e.key==="Enter"&&(e.preventDefault(),fe())}),document.getElementById("editMealOverlay").addEventListener("click",function(e){e.target===this&&(U(),S())}),document.getElementById("navOverlay").addEventListener("click",function(e){Wn()&&(U(),S())}),document.getElementById("tagInput").addEventListener("keypress",function(e){e.key==="Enter"&&(e.preventDefault(),fe())}),document.getElementById("editMealOverlay").addEventListener("click",function(e){e.target===this&&(U(),S())})}function Wn(){return document.querySelector(".meals-container")!=null}function Gn(){document.getElementById("add-ingredient-p").addEventListener("click",function(e){is(),$e()}),document.getElementById("closeIngredientBtn").addEventListener("click",function(e){J(),S()}),document.getElementById("addIngredientSubmitBtn").addEventListener("click",ds),document.getElementById("editIngredientOverlay").addEventListener("click",function(e){e.target===this&&(J(),S())}),document.getElementById("navOverlay").addEventListener("click",function(e){J(),S()})}async function Vn(){st.forEach(e=>{rt(e.name,e.dish_id,e.total_calories,e.preparation_time_in_min,JSON.parse(e.tags))}),B.forEach(e=>{at(e.name,e.ingredient_id,e.category)})}function Kn(e){document.querySelectorAll("#filter-bar-p button").forEach(n=>{n===e?(zn(e),n.classList.add("active-p"),n.classList.remove("notActive-p")):(n.classList.remove("active-p"),n.classList.add("notActive-p"))})}function zn(e){const t=document.querySelector("#ingredients-preferences"),n=document.querySelector("#meals-preferences"),s=e.textContent.trim(),o=document.getElementById("ingredientsPreferredWhole"),i=document.getElementById("ingredientsBlockedWhole"),r=document.getElementById("mealsPreferredWhole"),a=document.getElementById("mealsBlockedWhole");t.style.display=s==="Meals"?"none":"",n.style.display=s==="Ingredients"?"none":"",o.style.display=s==="Meals"?"none":"",i.style.display=s==="Meals"?"none":"",r.style.display=s==="Ingredients"?"none":"",a.style.display=s==="Ingredients"?"none":""}function Yn(e){const t=e.blockedDishes,n=e.blockedIngredients,s=e.preferredDishes,o=e.preferredIngredients,i=document.querySelectorAll(".dish-card-p"),r=document.querySelectorAll(".ingredient-card-p");Xn(i,s,t),Jn(r,o,n)}function Xn(e,t,n){e.forEach(s=>{const o=s.querySelector(".item-id").textContent.trim(),i=s.querySelector(".like"),r=s.querySelector(".dislike");t.includes(parseInt(o,10))&&i.classList.add("favorited"),n.includes(parseInt(o,10))&&r.classList.add("rejected")})}function Jn(e,t,n){e.forEach(s=>{const o=s.querySelector(".item-id").textContent.trim(),i=s.querySelector(".like"),r=s.querySelector(".dislike");t.includes(parseInt(o,10))&&i.classList.add("favorited"),n.includes(parseInt(o,10))&&r.classList.add("rejected")})}function ot(e){const[t,n]=e.split("-"),s=parseInt(n,10);if(!t||isNaN(s))throw new Error("Invalid dataId format: ".concat(e));return[t,s]}async function Be(e){const t=e.currentTarget,n=t.dataset.meal,[s,o]=ot(n),i=s==="ingredient",r=s==="dish";if(t.classList.toggle("favorited"),t.classList.contains("favorited")){const a=document.querySelector('[data-meal="'.concat(n,'"].dislike'));a&&a.classList.contains("rejected")&&(a.classList.remove("rejected"),P("rejected",!1,i,r)),P("favorited",!0,i,r),Z(s,o,"like").catch(l=>console.error("Failed to update preference:",l))}else P("favorited",!1,i,r),Z(s,o,"neutral").catch(a=>console.error("Failed to update preference:",a))}function De(e){const t=e.currentTarget,n=t.dataset.meal,[s,o]=ot(n),i=s==="ingredient",r=s==="dish";if(t.classList.toggle("rejected"),t.classList.contains("rejected")){const a=document.querySelector('[data-meal="'.concat(n,'"].like'));a&&a.classList.contains("favorited")&&(a.classList.remove("favorited"),P("favorited",!1,i,r)),P("rejected",!0,i,r),Z(s,o,"dislike").catch(l=>console.error("Failed to update preference:",l))}else P("rejected",!1,i,r),Z(s,o,"neutral").catch(a=>console.error("Failed to update preference:",a))}function P(e,t,n,s){if(n){const o=document.getElementById("ingredientsPreferred"),i=document.getElementById("ingredientsBlocked");e==="favorited"?Y(o,t):e==="rejected"&&Y(i,t)}else if(s){const o=document.getElementById("mealsPreferred"),i=document.getElementById("mealsBlocked");e==="favorited"?Y(o,t):e==="rejected"&&Y(i,t)}}function ne(e){const n={dish:{selector:".dish-card-p",counters:{preferred:"mealsPreferred",blocked:"mealsBlocked"}},ingredient:{selector:".ingredient-card-p",counters:{preferred:"ingredientsPreferred",blocked:"ingredientsBlocked"}}}[e];if(!n){console.error("Invalid item type: ".concat(e));return}const s=document.querySelectorAll(n.selector);let o=0,i=0;s.forEach(l=>{const d=l.querySelector(".like"),c=l.querySelector(".dislike");d!=null&&d.classList.contains("favorited")&&o++,c!=null&&c.classList.contains("rejected")&&i++});const r=document.getElementById(n.counters.preferred),a=document.getElementById(n.counters.blocked);r&&(r.textContent=o),a&&(a.textContent=i)}function Zn(){ne("dish")}function Qn(){ne("ingredient")}function es(){ne("dish"),ne("ingredient")}function Y(e,t){if(e){const n=Number(e.textContent)||0,s=t?n+1:n-1;e.textContent=Math.max(0,s)}}async function ts(){const e=document.getElementById("ingredientsContainer");B.forEach(t=>{const n=it(t.Unit_of_Measurement);e.innerHTML+='\n    <li class="card ingredient">\n            <input class="checkbox-overlay" type="checkbox">\n            <span class="ingredient-text-p">'.concat(t.name,'</span>\n            <div class="ingredient-amount-p">\n                <input type="number" class="form-input ingredient" placeholder="0">\n                <span class="amount-text-p">').concat(n,"</span>\n            </div>\n    </li>\n  ")})}function it(e){return e?e.replace(/[0-9]/g,"").toLowerCase():""}function ns(){const e=document.querySelectorAll("#ingredientsContainer .checkbox-overlay"),t=[];return e.forEach((n,s)=>{if(n.checked){const i=n.closest(".card.ingredient").querySelector(".form-input.ingredient"),r=parseFloat(i.value)||0;t.push([s,r])}}),t}function ss(){const e=ns();let t=0,n=0,s=0,o=0,i=[];return e.forEach(r=>{const[a,l]=r;t+=B[a].calories_per_UoM/100*l,n+=B[a].protein_per_UoM/100*l,s+=B[a].carbs_per_UoM/100*l,o+=B[a].fats_per_UoM/100*l;let d=it(B[a].Unit_of_Measurement);i.push({ingredient_id:B[a].ingredient_id,unit_of_measurement:d,amount:l})}),{calories:Math.round(t),protein:Math.round(n),carbs:Math.round(s),fat:Math.round(o),ingredients:i}}function os(){const e=document.getElementById("editMealOverlay"),t=e.querySelector(".form-section");document.body.style.overflow="hidden",e.classList.remove("hidden"),t&&(t.scrollTop=0),ts()}function U(){const e=document.getElementById("editMealOverlay");e&&(e.classList.add("hidden"),document.body.style.overflow="auto")}function is(){const e=document.getElementById("editIngredientOverlay"),t=e.querySelector(".form-section-ingredient");document.body.style.overflow="hidden",e.classList.remove("hidden"),t&&(t.scrollTop=0)}function J(){const e=document.getElementById("editIngredientOverlay");e&&(e.classList.add("hidden"),document.body.style.overflow="auto")}function fe(){const e=document.getElementById("tagInput"),t=e.value.trim();if(t){const n=document.getElementById("tagsContainer"),s=document.createElement("div");s.className="tag-o-p",s.innerHTML="\n                    <span>".concat(t,'</span>\n                    <button class="tag-remove">\n                    <img src="./assets/icons/remove-tag.svg" alt="">\n                    </button>\n                '),n.appendChild(s),e.value="";const o=document.querySelector(".tag-remove");o.addEventListener("click",function(){o.parentElement.remove()})}}function rs(e){if(!e.name||e.name.trim()==="")return alert("Please enter a meal name."),!1;if(!e.time||isNaN(e.time)||parseInt(e.time)<=0)return alert("Please enter a valid cooking time (greater than 0)."),!1;if(!e.vmScore||isNaN(e.vmScore))return alert("Please enter a valid VM score."),!1;if(!e.category||e.category==="Select Category"||e.category==="Protein")return alert("Please select a valid category."),!1;if(!e.preparation||e.preparation.trim()==="")return alert("Please enter cooking instructions."),!1;if(!e.ingredients||e.ingredients.length===0)return alert("Please select at least one ingredient."),!1;for(let t of e.ingredients)if(!t.amount||isNaN(t.amount)||parseFloat(t.amount)<=0)return alert("Please enter a valid amount for ingredient ID: ".concat(t.ingredient_id,".")),!1;return!0}function rt(e,t,n,s,o=[],i="#dishes-list-p"){const r="dish-".concat(t),a=o.map(E=>'<button class="tag-p">'.concat(E,"</button>")).join(""),l='\n    <li class="card drop-shadow dish-card-p">\n        <div class="swipe-delete">Delete</div>\n        <div class="swipe-content">\n            <span class="item-id">'.concat(t,'</span>\n            <div class="first-row-of-dish">\n                <div class="descr-p">\n                    <h3 class="title-p">').concat(e,'</h3>\n                    <div class="dish-info-p">\n                        <p class="subtext">').concat(n,' ckal</p>\n                        <div class="subtext-point"></div>\n                        <p class="subtext">').concat(s,' min</p>\n                    </div>\n                </div>\n                <div class="preference-buttons">\n                    <button class="like" data-meal="').concat(r,'">\n                        <svg class="star-icon" src="./assets/icons/star.svg" alt="star"></svg>\n                    </button>\n                    <button class="dislike" data-meal="').concat(r,'">\n                        <svg class="cross-icon" viewBox="0 0 24 24" fill="none" stroke-width="2"\n                            stroke-linecap="round" stroke-linejoin="round">\n                            <line x1="18" y1="6" x2="6" y2="18"></line>\n                            <line x1="6" y1="6" x2="18" y2="18"></line>\n                        </svg>\n                    </button>\n                </div>\n            </div>\n            <div class="tags-container-p">\n                ').concat(a,"\n            </div>\n        </div>\n    </li>\n    "),d=document.querySelector(i);if(!d)return;d.insertAdjacentHTML("beforeend",l);const c=d.lastElementChild,m=c.querySelector(".like"),g=c.querySelector(".dislike");m.addEventListener("click",Be),g.addEventListener("click",De)}async function as(){const e=document.getElementById("addBtn-p");e.disabled=!0;const t=ss(),n=document.getElementById("mealName-p").value,s=t.calories,o=t.protein,i=t.fat,r=t.carbs,a=document.getElementById("time-p").value,l=document.getElementById("vmScore-p").value;let d=document.getElementById("category-p").textContent.trim();const c=Array.from(document.querySelectorAll(".tag-o-p span")).map(f=>f.textContent),m=t.ingredients,g=document.getElementById("instructions-p").value,E=JSON.stringify(c);d==="lunch/dinner"&&(d="Main");const h={name:n,preparation:g,vmScore:l,category:d,time:a,calories:s,protein:o,fat:i,carbs:r,tags:E,ingredients:m};if(rs(h)){U();const y=(await en(h)).dishId;rt(n,y,s,a,c),cs()}e.disabled=!1}function cs(){document.getElementById("mealName-p").value="",document.getElementById("time-p").value="",document.getElementById("vmScore-p").value="",document.getElementById("instructions-p").value="",document.getElementById("tagsContainer").innerHTML="",document.getElementById("ingredientsContainer").innerHTML="",document.getElementById("category-p").textContent="breakfast";const e=document.getElementById("editMealOverlay");e.scrollTop=0;const t=e.querySelector(".add-meal-card");t&&(t.scrollTop=0)}function at(e,t,n,s="ingredients-list-p"){const o="ingredient-".concat(t),i='\n        <li class="card drop-shadow ingredient-card-p">\n            <span class="item-id">'.concat(t,'</span>\n            <div class="swipe-delete">Delete</div>\n            <div class="swipe-content">\n                <div class="descr-p">\n                    <h3 class="title-p">').concat(e,'</h3>\n                    <p class="subtext">').concat(n,'</p>\n                </div>\n\n                <div class="preference-buttons">\n                    <button class="like" data-meal="').concat(o,'">\n                        <img class="star-icon" src="./assets/icons/star.svg" alt="star">\n                    </button>\n                    <button class="dislike" data-meal="').concat(o,'">\n                        <svg class="cross-icon" viewBox="0 0 24 24" fill="none" stroke-width="2"\n                            stroke-linecap="round" stroke-linejoin="round">\n                            <line x1="18" y1="6" x2="6" y2="18"></line>\n                            <line x1="6" y1="6" x2="18" y2="18"></line>\n                        </svg>\n                    </button>\n                </div>\n            </div>\n        </li>\n    '),r=document.getElementById(s);if(!r)return;r.insertAdjacentHTML("beforeend",i);const a=r.lastElementChild,l=a.querySelector(".like"),d=a.querySelector(".dislike");l.addEventListener("click",Be),d.addEventListener("click",De)}function ls(e){return!e.name||e.name.trim()===""?(alert("Please enter an ingredient name."),document.getElementById("ingredientName-p").focus(),!1):!e.category||e.category.trim()===""||e.category==="Select Category"?(alert("Please select a category."),document.getElementById("ingredientCategory-p").focus(),!1):isNaN(e.calories)||e.calories<=0?(alert("Please enter a valid number for calories (must be greater than 0)."),document.getElementById("ingredientCalories-p").focus(),!1):isNaN(e.protein)||e.protein<0?(alert("Please enter a valid number for protein (0 or more)."),document.getElementById("ingredientProtein-p").focus(),!1):isNaN(e.fats)||e.fats<0?(alert("Please enter a valid number for fat (0 or more)."),document.getElementById("ingredientFat-p").focus(),!1):isNaN(e.carbs)||e.carbs<0?(alert("Please enter a valid number for carbs (0 or more)."),document.getElementById("ingredientCarbs-p").focus(),!1):!e.uom||e.uom.trim()===""||e.uom==="Select Unit"?(alert("Please select a unit."),document.getElementById("ingredientUnit-p").focus(),!1):!0}async function ds(){const e=document.getElementById("addIngredientSubmitBtn");e.disabled=!0;const t=document.getElementById("ingredientName-p").value.trim(),n=document.getElementById("ingredientCategory-p").textContent.trim(),s=document.getElementById("ingredientProtein-p").value.trim(),o=document.getElementById("ingredientFat-p").value.trim(),i=document.getElementById("ingredientCarbs-p").value.trim(),r=document.getElementById("ingredientCalories-p").value.trim(),a=document.getElementById("ingredientUnit-p").textContent.trim();let l=document.getElementById("ingredientUnit-p").textContent.trim();(a==="grams"||a==="milliliters")&&(l="100 ".concat(document.getElementById("ingredientUnit-p").textContent.trim()));const d={name:t,uom:l,calories:r,carbs:i,fats:o,protein:s,category:n};if(ls(d)){J(),S();const m=(await tn(d)).ingredientId;at(t,m,n),us()}e.disabled=!1}function us(){document.getElementById("ingredientName-p").value="",document.getElementById("ingredientProtein-p").value="",document.getElementById("ingredientFat-p").value="",document.getElementById("ingredientCarbs-p").value="",document.getElementById("ingredientCalories-p").value="",document.getElementById("ingredientCategory-p").textContent="fruits",document.getElementById("ingredientUnit-p").textContent="piece"}function le(){const e=D(),t={user:"#1BCE86",cook:"#7F8DFF",admin:"#E35252"};switch(e.role){case"user":document.documentElement.style.setProperty("--accent-color",t.user);break;case"cook":document.documentElement.style.setProperty("--accent-color",t.cook);break;case"admin":document.documentElement.style.setProperty("--accent-color",t.admin);break;default:document.documentElement.style.setProperty("--accent-color",t.user)}}function ms(){const e=D(),t=document.getElementById("admin-panel");if(e&&e.role==="admin"){const n=document.querySelector("#home-container");n.style.gridTemplateRows="auto auto 1fr",t.classList.remove("hidden-admin-panel")}else t.classList.add("hidden-admin-panel")}function fs(){const e=D();e&&(e.role==="cook"||e.role==="admin")&&document.querySelectorAll(".add-item-p").forEach(n=>{n.style.display="flex"})}async function gs(){if(z("cook")||z("admin")){const e=document.getElementById("ingredients-list-p");e&&H(e,".ingredient-card-p",hs)}if(z("cook")||z("admin")){const e=document.querySelector("#dishes-list-p");e&&H(e,".dish-card-p",ps)}}async function hs(e){Qn(),await sn(e)}async function ps(e){Zn(),await nn(e)}const ge=new Map,ys=2;let se=new Map;const vs=1;async function ws(e,t,n,s){const[o,i,r]=await Promise.all([Ue("breakfast"),Ue("main"),et()]);console.log("Dishes for breakfast:",o),console.log("Dishes for main:",i),console.warn("[algo.js] => Preferences loaded:",r);const a=Is(e,0),l=[];for(let d=0;d<7;d++){const c=await ks(a,o,i,r),m=Es(c,a);l.push(m)}return console.log("Generated week plan:",l),l}function Es(e,t){return{breakfast:he(e.breakfast,t[0]),lunch:he(e.lunch,t[1]),dinner:he(e.dinner,t[2]),puffer:null}}function he(e,t){if(e.total_calories===t)return e;const[s,o]=ct(e.total_calories,.2);if(s<=t&&t<=o){const i=t/e.total_calories;return pe(e,i)}if(t>o){const i=o/e.total_calories;return pe(e,i)}if(t<s){const i=s/e.total_calories;return pe(e,i)}return e}function pe(e,t){var o;const n=((o=e.ingredients)==null?void 0:o.map(i=>({...i,amount_scaled:(i.amount*t).toFixed(1)})))||[];return{dish_id:e.dish_id,name:e.name,preparation:e.preparation,vm_score:e.vm_score,meal_category:e.meal_category,preparation_time_in_min:e.preparation_time_in_min,total_calories:Math.round(e.total_calories*t),total_protein:Math.round(e.total_protein*t),total_fat:Math.round(e.total_fat*t),total_carbs:Math.round(e.total_carbs*t),tags:e.tags,ingredients:n,factor:t}}async function ks(e,t,n,s){console.log("DAY START"),se=new Map;const o=e[0],i=e[1],r=e[2];e[3];const a={breakfast:null,lunch:null,dinner:null,puffer:null};return a.breakfast=await ye(o,t,s),a.lunch=await ye(i,n,s),bs(a.lunch),a.dinner=await ye(r,n,s),a}function bs(e){if(e){const t=se.get(e.dish_id)||0;se.set(e.dish_id,t+1)}}function Is(e,t){switch(t){case 0:return[e*.24,e*.38,e*.38];case 1:return[e*.2,e*.35,e*.35,e*.1];case 2:return[e*.17,e*.32,e*.32,e*.19];default:return[]}}async function ye(e,t,n){for(let o=0;o<=.2;o=o+.05){const i=xs(e,o),r=t.filter(a=>{const l=ct(a.total_calories,.2);return Bs(l,i)});if(r.length>0)return await Ss(r,n)}return Ls(e)}function Ls(e){return console.warn("⚠️ Kein Gericht gefunden für kcal-Ziel ".concat(e)),{name:"Kein Gericht gefunden",preparation:"-",total_calories:0,total_protein:0,total_fat:0,total_carbs:0,vm_score:0,preparation_time_in_min:0}}async function Ss(e,t){if(e.length===1)return console.log("only one candidate found"),e[0];const n=new Set(t.preferredDishes||[]),s=new Set(t.preferredIngredients||[]),o=new Set(t.blockedDishes||[]),i=new Set(t.blockedIngredients||[]);function r(f){for(let y=f.length-1;y>0;y--){const x=Math.floor(Math.random()*(y+1));[f[y],f[x]]=[f[x],f[y]]}return f}const a=[],l=[],d=[],c=[],m=[],g=[];for(const f of e){const y=f.dish_id,x=ge.get(y)||0;if((se.get(y)||0)>=vs){c.push(f);continue}if(x>=ys){f._source="duplicates (global)",c.push(f);continue}n.has(y)?(f._source="preferredDishes",a.push(f)):Ke(f,s)?(f._source="preferredIngredients",l.push(f)):o.has(y)?(f._source="blockedDishes",g.push(f)):Ke(f,i)?(f._source="blockedIngredients",m.push(f)):(f._source="neutral",d.push(f))}const E=[...r(a),...r(l),...r(d),...r(c),...r(m),...r(g)],h=E[0];if(h){const f=ge.get(h.dish_id)||0;ge.set(h.dish_id,f+1)}return Cs(E),h||null}function Cs(e){const t=e.map(n=>({dish_id:n.dish_id,source:n._source||"unknown"}));console.warn("[Debug] Zusammengesetztes Kandidaten-Array:",t)}function Ke(e,t){return Array.isArray(e.ingredientIDs)?e.ingredientIDs.some(n=>t.has(n)):!1}function xs(e,t){const n=e*t;return[e-n,e+n]}function ct(e,t){const n=e*t;return[e-n,e+n]}function Bs(e,t){const[n,s]=e,[o,i]=t;return s>=o&&n<=i}async function Ds(){W();const e=document.getElementById("app"),t=await T("./html-pages/plan.html");e.innerHTML=t,R(document.getElementById("meal-plan")),ae();const{today:n,currentWeek:s}=ut();await _s(n,s),Zs(n,s),ce()}async function _s(e,t){As(e,t);const n=await lt();await Ts(e,t,n),_e(n)}async function Ts(e,t,n){const s=await pt(t,n);vt(s,n)}async function lt(){let e=await on();return(!e||e.length===0)&&(console.warn("Week plan not found in database. Generating a new one..."),e=await dt()),console.warn("Week plan loaded from DB:",e),e}async function dt(){let e=await ht();return console.log("Optimal daily Calories!: "+e),await ws(e)}function ut(){const e=new Date,t=Ps(e);return{today:e,currentWeek:t}}function As(e,t){const n=e.getMonth(),s=e.getFullYear();qs(["January","February","March","April","May","June","July","August","September","October","November","December"],n,s),Ms(e,t)}function Ps(e){const t=new Date(e),n=e.getDay(),s=n===0?6:n-1;t.setDate(e.getDate()-s);const o=[];for(let i=0;i<7;i++){const r=new Date(t);r.setDate(t.getDate()+i),o.push(r)}return o}function qs(e,t,n){const s=document.getElementById("monthYear");s&&(s.innerHTML="".concat(e[t],"<br>").concat(n))}function Ms(e,t){const n=document.getElementById("daysGrid");if(!n)return;n.innerHTML="";const s=e.getMonth();t.forEach(o=>{const i=document.createElement("div");i.className="day",i.textContent=o.getDate(),i.setAttribute("data-day",o.getDate()),o.toDateString()===e.toDateString()&&i.classList.add("selected"),o.getMonth()!==s&&i.classList.add("other-month"),n.appendChild(i)})}function ze(e,t,n,s){return e==="male"?66.47+13.75*n+5*s-6.755*t:655.1+9.563*n+1.85*s-4.676*t}function Ye(e,t,n,s){const o=10*n+6.25*s-5*t;return e==="male"?o+5:o-161}function $s(e){const t=e.toLowerCase();return{"very low":1.2,low:1.375,moderate:1.55,active:1.725,"very active":1.9}[t]||1.55}const mt=-200,ft=0,gt=200;function Os(e){const t=e.toLowerCase().trim();return{"losing weight":mt,"maintaining weight":ft,"gaining weight":gt}[t]||0}function Us(e,t,n,s,o,i){let r=0;switch(i){case mt:r=ze(e,t,n,s);break;case ft:r=(Ye(e,t,n,s)+ze(e,t,n,s))/2;break;case gt:r=Ye(e,t,n,s);break}const a=r*o;return Math.round(a+i)}async function ht(){let e=0;const{gender:t,age:n,weight_kg:s,weight_pounds:o,height_cm:i,height_feet_and_inches:r,activityLevel:a,goal:l}=await Qe();if(t&&n&&s&&i&&a&&l){const d=t.toLowerCase().trim(),c=n,m=s,g=i,E=$s(a),h=Os(l);e=Us(d,c,m,g,E,h),console.log("Calculated optimal calories: "+e)}return e}async function pt(e,t){const n={};return e.forEach((s,o)=>{const i=s.getDate();n[i]=Ns(t[o])}),Je(t),n}function Ns(e){let t="";return t+=ve(e.breakfast,"Breakfast"),t+=ve(e.lunch,"Lunch"),t+=ve(e.dinner,"Dinner"),t}function yt(){const e=document.querySelector(".day.selected");return e?parseInt(e.getAttribute("data-day")):null}function ve(e,t){var n;return'\n    <div class="card drop-shadow plan-meal-card" data-id="'.concat(e.dish_id,'">\n        <div class="meal-header-mp">\n            <div>\n                <h3 class="meal-title-mp">').concat(e.name,'</h3>\n                <p class="subtext">').concat(t,'</p>\n            </div>\n            <div class="meal-calories-mp">').concat(e.total_calories,' kcal</div>\n        </div>\n        <div class="nutrition-values-mp">\n            <div class="nutrition-item-mp">\n                <p class="nutrition-value-mp">').concat(e.total_protein,'g</p>\n                <p class="nutrition-label-mp subtext">Protein</p>\n            </div>\n            <div class="nutrition-item-mp">\n                <p class="nutrition-value-mp">').concat(e.total_carbs,'g</p>\n                <p class="nutrition-label-mp subtext">Carbs</p>\n            </div>\n            <div class="nutrition-item-mp">\n                <p class="nutrition-value-mp">').concat(e.total_fat,'g</p>\n                <p class="nutrition-label-mp subtext">Fat</p>\n            </div>\n            <div class="nutrition-item-mp">\n                <p class="nutrition-value-mp">').concat(e.vm_score,'</p>\n                <p class="nutrition-label-mp subtext">VM score</p>\n            </div>\n        </div>\n        <div class="meal-details-mp">\n            <div class="footer-mp">\n                <img class="clock-logo-mp" src="./assets/icons/clock.svg" alt="clock">\n                <p class="footer-text-mp">').concat(e.preparation_time_in_min,'</p>\n            </div>\n            <div class="footer-mp">\n                <img class="users-logo-mp" src="./assets/icons/users.svg" alt="users">\n                <p class="footer-text-mp">').concat(((n=e.factor)!=null?n:1).toFixed(1)," serving</p>\n            </div>\n        </div>\n    </div>\n    ")}function ke(e,t){const n=t[e]||"",s=document.getElementById("content-section");s&&(s.innerHTML=n)}function vt(e,t){document.querySelectorAll(".day").forEach(s=>{s.replaceWith(s.cloneNode(!0))}),document.querySelectorAll(".day").forEach(s=>{s.addEventListener("click",()=>{document.querySelectorAll(".day").forEach(i=>i.classList.remove("selected")),s.classList.add("selected");const o=parseInt(s.getAttribute("data-day"));ke(o,e),_e(t)})});const n=yt();n&&ke(n,e)}function _e(e){document.getElementById("viewDishOverlay").addEventListener("click",function(n){n.target===this&&(we(),S(),Ee(),F(0),N(0))}),document.getElementById("navOverlay").addEventListener("click",function(n){Fs()&&(we(),S(),Ee(),F(0),N(0))}),document.querySelector("#close-view-dish").addEventListener("click",function(n){we(),S(),Ee(),F(0),N(0)}),document.getElementById("reset-cooking-process").addEventListener("click",function(n){document.querySelectorAll("#view-dish-instructions-list .checkbox-overlay:checked").forEach(o=>{o.checked=!1}),F(0),N(0)}),document.querySelectorAll(".plan-meal-card").forEach(n=>{const s=n.dataset.id;n.addEventListener("click",()=>{Rs(),$e(),Gs(s,e),Hs()})})}function Fs(){return document.querySelector("#meal-plan")!=null}function Hs(){document.querySelectorAll(".checkbox-overlay").forEach(t=>{t.addEventListener("change",n=>{const s=document.querySelectorAll("#view-dish-instructions-list .checkbox-overlay:checked");F(s.length),N(s.length)})})}function N(e){let t="0%";if(e!==0){const o=wt();t=(e/o*100).toFixed(1)+"%"}const n=document.getElementById("cooking-progress-fill"),s=document.getElementById("view-%-steps");n.style.width=t,s.textContent=t}function Rs(){const e=document.getElementById("viewDishOverlay");e&&(e.classList.remove("hidden"),document.body.style.overflow="hidden")}function we(){const e=document.getElementById("viewDishOverlay");e&&(e.classList.add("hidden"),document.body.style.overflow="auto")}function js(e,t){for(const n of t)for(const s of Object.values(n))if(s&&s.dish_id===Number(e))return s;return null}function Ws(e){const t=e.match(/(\d)([^0-9]+)/g),n={};return t&&t.forEach(s=>{const o=s.match(/^\d/)[0],i=s.slice(2).trim();n[o]=i}),n}function wt(){return document.getElementById("view-dish-instructions-list").querySelectorAll("li").length}function F(e){document.getElementById("view-completed-number").textContent=e}function Ee(){const e=document.getElementById("view-dish-instructions-list"),t=document.getElementById("view-dish-ingredients-list");e.innerHTML="",t.innerHTML=""}function Gs(e,t){const n=js(e,t);Ys(n),Ks(n.ingredients);let s=Ws(n.preparation);zs(s),Vs()}function Vs(){const e=wt();document.getElementById("view-total-number").textContent=e}function Ks(e){const t=document.getElementById("view-dish-ingredients-list");for(const n in e){let s=Xs(e[n]);t.insertAdjacentHTML("beforeend",s)}}function zs(e){const t=document.getElementById("view-dish-instructions-list");Object.entries(e).forEach(([n,s])=>{const o=Js(n,s);t.insertAdjacentHTML("beforeend",o)})}function Ys(e){document.getElementById("view-dish-name").textContent=e.name,document.getElementById("view-kcal").textContent=e.total_calories,document.getElementById("view-prep-time").textContent=e.preparation_time_in_min,document.getElementById("view-protein-amount").textContent=e.total_protein+"g",document.getElementById("view-carbs-amount").textContent=e.total_carbs+"g",document.getElementById("view-fat-amount").textContent=e.total_fat+"g",document.getElementById("view-vm-score").textContent=e.vm_score}function Xs(e){return'\n    <li class="view-dish-ingredient-el">\n        <p class="view-dish-ingredient-name">'.concat(e.name,'</p>\n        <p class="subtext view-dish-ingredient-amount">').concat(e.amount_scaled," ").concat(e.unit_of_measurement,"</p>\n    </li>\n    ")}function Js(e,t){return'\n    <li class="view-instruction-step-el">\n        <input type="checkbox" class="checkbox-overlay">\n        <div class="view-instruction-text-container">\n            <p class="view-instruction-header">Step '.concat(e,'</p>\n            <p class="view-instruction-text">').concat(t,"</p>\n        </div>\n    </li>\n    ")}function Zs(e,t){const n=document.querySelector("#regenerate-plan");n&&n.addEventListener("click",async()=>{const s=yt(),o=await dt(),i=await pt(t,o);await gn();let r=await Lt(o);r=await Ct(r),await oe(r),vt(i,o),s&&ke(s,i),_e(o)})}function Qs(){const e=localStorage.getItem("soundEnabled");return e===null?!0:e==="true"}function eo(e,t){if(!Qs())return;const n=new Audio("./assets/sounds/".concat(t));n.volume=e,n.play()}function be(){eo(.2,"checkbox.mp3")}async function Et(){W();const e=document.getElementById("app"),t=await T("./html-pages/home.html");e.innerHTML=t,R(document.getElementById("home-container")),ae(),ms(),le(),setTimeout(()=>{It()},1),await kt(),ce()}function to(){document.querySelectorAll(".tab").forEach(e=>{e.addEventListener("click",async function(){document.querySelectorAll(".tab").forEach(t=>{t.classList.remove("active")}),this.classList.add("active"),await kt()})})}function no(){const e=document.getElementById("checked-circle");e&&e.addEventListener("change",async()=>{be(),await so(100);let t=await Ae(),n="breakfast";[t,n]=await mo(t);let s=fo(t,n);await Te(t),setTimeout(()=>{Ie(s,n),e.checked=!1},300)})}async function so(e){return new Promise(t=>setTimeout(t,e))}async function kt(){const e=document.querySelector(".tab.active"),t=document.getElementById("admin-container");if(e&&e.textContent.trim()==="Standard"&&t){const n=await T("./html-pages/homeStandard.html");t.innerHTML=n;let s=await Ae();await oe(s),bt(s),po(s),await Te(s),to()}else{const n=await T("./html-pages/homeRoles.html");t.innerHTML=n,await Bt()}}function bt(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const s=t[n],o=e[s];if(o&&!o.eaten){Ie(o,s);return}}Ie(null)}function It(){const e=D(),t=document.getElementById("greeting-container");t&&(t.innerHTML='\n        <div id="greeting-text">\n            <span class="roboto">Hi,</span>\n            <span class="roboto">'.concat(e.username,'</span>\n        </div>\n        <div id="card-um').concat(_(e.role),'" class="tag">\n            <img class="tag-logo" src="./assets/icons/userRoleIcon').concat(_(e.role),'.svg" alt="tag">\n            <span id="text-um').concat(_(e.role),'" class="tag-text">').concat(xt(e.role),"</span>\n        </div>\n        "))}function oo(e,t){for(let n=0;n<t.length;n++)if(t[n].getTime()===e.getTime())return n}async function Lt(e=null){const{today:t,currentWeek:n}=ut(),s=oo(t,n);return e||(e=await lt(),Je(e)),e[s]}function io(e){let t=0;const n=Object.keys(e);for(let s=0;s<n.length-1;s++){const o=n[s];e[o].eaten&&(t+=e[o].total_calories)}return t}function ro(e){return Object.values(e).filter(n=>n!=null).length}async function St(e,t){let n=e/t*100;return n>100?100:n}async function Te(e){let t=await ht(),n=io(e);console.log("Eaten Kcal:",n),console.log("Optimal Kcal:",t),co(n),await ao(n,t),lo(e),uo(n,t),go(e)}async function ao(e,t){const n=document.querySelector(".progress-bar");if(n){let s=await St(e,t);n.style.setProperty("--progress-in-percent",s)}}function co(e){const t=document.querySelector(".progress-text");t&&(t.textContent="".concat(e," kcal"))}async function lo(e){const t=ro(e),n=document.getElementById("planned-meals-h");t&&n&&(n.textContent=t)}async function uo(e,t){const n=await St(e,t),s=document.getElementById("goal-percentage-h");s&&(s.textContent="".concat(Math.round(n),"%"))}async function Ae(e=!1){let t=await ln();if(!t||Object.keys(t).length===0||e){let n=await Lt();t=Ct(n),console.log("First meals save:",t)}return t}function Ct(e,t=!1){return Object.keys(e).forEach(n=>{e[n]&&(e[n].eaten=t)}),e}async function mo(e){const t=Object.keys(e);for(let n=0;n<t.length-1;n++){const s=t[n];if(!e[s].eaten){const o=t[n+1];return e[s].eaten=!0,await oe(e),[e,o]}}return[null,null]}function fo(e,t){return e[t]||null}function go(e){const t=document.getElementById("todays-meals-container");if(t){const n=Object.keys(e);for(let s=0;s<n.length-1;s++){const o=n[s];for(const i of t.children){let r=i.querySelector(".item-id").textContent;s===Number(r)&&(e[o].eaten?i.querySelector(".check-point-db").classList.add("active"):i.querySelector(".check-point-db").classList.remove("active"))}}}}function ho(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Ie(e,t){if(!e){vo();return}const n=document.querySelector(".congratulations-message-db");n&&n.remove();const s=document.querySelector(".next-meal-container");s&&(s.innerHTML='   <div class="card drop-shadow next-meal-card-db">\n                <div class="first-row-db">\n                    <input id="checked-circle" class="checkbox" type="checkbox">\n\n                    <div class="next-meal-info">\n                        <div class="next-meal-info-texts">\n                            <h3 class="meal-name-db">'.concat(e.name,'</h3>\n                            <span class="subtext meal-category-h">').concat(ho(t),'</span>\n                        </div>\n\n                        <span class="calories-db">\n                        ').concat(e.total_calories,' kcal\n                        </span>\n                    </div>\n                </div>\n\n                <div class="nutrition-values-db">\n                    <div class="nutrition-item-db">\n                        <p class="nutrition-value-db">').concat(e.total_protein,'</p>\n                        <p class="nutrition-label-db subtext">Protein</p>\n                    </div>\n                    <div class="nutrition-item-db">\n                        <p class="nutrition-value-db">').concat(e.total_carbs,'</p>\n                        <p class="nutrition-label-db subtext">Carbs</p>\n                    </div>\n                    <div class="nutrition-item-db">\n                        <p class="nutrition-value-db">').concat(e.total_fat,'</p>\n                        <p class="nutrition-label-db subtext">Fat</p>\n                    </div>\n                </div>\n            </div>\n        ')),no()}function po(e){const t=document.getElementById("todays-meals-container");if(t&&t.children.length===0){const n=Object.keys(e);for(let s=0;s<n.length-1;s++){const o=n[s];t.appendChild(yo(s,e,o))}}}function yo(e,t,n){let s=t[n];const o=document.createElement("li");return o.className="card drop-shadow mealcards-db",o.innerHTML='<div class="check-point-db"></div>\n                    <div class="todays-meal-info">\n                        <span class="item-id">'.concat(e,'</span>\n                        <h3 class="meal-name-db">').concat(s.name,'</h3>\n                        <span class="subtext">').concat(n,'</span>\n                    </div>\n                    <h3 class="todays-calories">').concat(s.total_calories," kcal</h3>"),o}function vo(){const e=document.querySelector(".next-meal-container");document.querySelector(".congratulations-message-db")||(e.innerHTML='\n        <div class="congratulations-message-db">     \n            <span> Congratulations! 🎉</span>\n            <span>You have achieved your goal!</span> \n            <button id="congrats-link">reset</button>\n        </div>\n        ',wo())}function wo(){document.getElementById("congrats-link").addEventListener("click",async()=>{let e=await Ae(!0);await oe(e),bt(e),await Te(e)})}function _(e){if(e==="user")return 1;if(e==="cook")return 2;if(e==="admin")return 3}function xt(e){if(e==="user")return"User";if(e==="cook")return"Chef";if(e==="admin")return"Admin"}function Eo(e){if(e==="User")return"user";if(e==="Chef")return"cook";if(e==="Admin")return"admin"}function ko(e){return e.split(" ").map(t=>t[0].toUpperCase()).join("").slice(0,2)}async function Bt(){const e=document.getElementById("user-list");e.innerHTML="",(await Xt()).forEach(i=>{const r=ko(i.username),a=document.createElement("li");a.classList.add("card","user"),a.innerHTML='\n        <div class="swipe-delete">Delete</div>\n        <div class="swipe-content">\n            <span class="item-id">'.concat(i.user_id,'</span>\n            <div class="profile-picture">\n                <span>').concat(r,'</span>\n            </div>\n            <div class="user-data">\n                <span class="user-name">').concat(i.username,'</span>\n                <span class="user-email">').concat(i.email,'</span>\n            </div>\n            <div id="user-role">\n                <div class="user-tag" id="card-um').concat(_(i.role),'">\n                    <img class="user-tag-logo" src="./assets/icons/userRoleIcon').concat(_(i.role),'.svg" alt="tag">\n                    <span id="text-um').concat(_(i.role),'" class="user-tag-text">').concat(xt(i.role),'</span>\n                </div>\n                <object id="change-role" src="./assets/icons/change-role.svg" alt="change role"></object>\n            </div>\n        </div>\n        '),e.appendChild(a)}),Dt(),e&&H(e,".card.user",bo),document.querySelectorAll("#change-role").forEach(i=>{i.addEventListener("click",Lo)}),ee("user-search-bar",["#user-list"])}async function bo(e){Qt(e),setTimeout(()=>{},2e3),console.warn("TOTAL USERS ARE BEING RENDERED AGAIN"),Dt()}function Io(e,t,n){if(e==="admin"){const s=D();if(s.email===n)throw alert("You cannot change your own role."),new Error("Admin role change denied for self.");if(s.name!=="admin"&&s.email!=="admin@admin.com")throw alert("You cannot change the role of an admin."),new Error("Admin role change denied for super user.")}}async function Lo(e){const t=e.target.closest(".user"),n=t.querySelector(".user-name").textContent,s=t.querySelector(".user-email").textContent,o=t.querySelector(".user-tag-text").textContent,i=Eo(o);Io(i,n,s);const r=_(i)%3,l=["user","cook","admin"][r];await Zt(l,s),Bt(),It()}function So(){const e=document.getElementById("user-list");return e?e.querySelectorAll("li").length:0}function Dt(){const e=document.getElementById("total-users-amount");e&&(e.textContent=So())}const X=new Map;async function Co(){W();const e=document.getElementById("app"),t=await T("./html-pages/list.html");e.innerHTML=t,R(document.getElementById("list-container")),ae(),xo();const n=await Bo();Do(n),_t(),j(),To();const s=document.querySelector(".grocery-list");H(s,".grocery-item",Tt)}function xo(){ce(),document.querySelectorAll("#filter-bar button").forEach(t=>{t.addEventListener("click",()=>{Zo(t)})}),document.getElementById("add-item-btn").addEventListener("click",()=>{document.getElementById("newItem")||Wo("grocery-item drop-shadow addingContainer")})}function _t(){document.querySelector(".grocery-list").addEventListener("click",zo)}async function Bo(){let e=await un();return e&&e.length>0?console.warn("Lade User List Items aus DB:",e):(console.warn("Keine User List Items gefunden – lade aus WeekPlan ..."),e=await rn(),console.log("Ingredients from week plan:",e),await dn(e)),e}function Do(e){e.forEach(t=>At(t))}function j(){const e=document.querySelectorAll(".grocery-list li"),t=_o(e),n=e.length,s=document.getElementById("checked-count-gl"),o=document.getElementById("total-count-gl");s&&o?(s.textContent="".concat(t.length),o.textContent="".concat(n)):console.warn("Checked count or total count element not found!")}function _o(e){return Array.from(e).filter(t=>t.querySelector(".checkbox-gl").checked)}function To(){ee("search-groceries",[".grocery-list"])}function Tt(e){console.log("Deleting item with identifier:",e),fn(e),j()}function At(e){const t=document.querySelector(".grocery-list"),n=document.createElement("li");n.className="grocery-item drop-shadow",n.innerHTML=Pt(e),Pe(n,e),de(n,e),e.is_checked&&qt(n),t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)}function Pt(e){const t=qe(e),n=e.is_checked?"checked":"";return'\n        <div class="swipe-delete">Delete</div>\n        <div class="swipe-content">\n            <span class="item-id">'.concat(t,'</span>\n            <input class="checkbox checkbox-gl" type="checkbox" ').concat(n,' />\n            <div class="item-details">\n                <h3>').concat(e.name,'</h3>\n                <span class="category subtext">').concat(e.category,'</span>\n            </div>\n            <div class="quantity-control">\n                <button class="minus-btn"><svg src="./assets/icons/minus.svg" alt="-"></svg></button>\n                <span class="amount">').concat(Math.round(e.amount),'</span>\n                <span class="unit">').concat(Mt(e.unit_of_measurement),'</span>\n                <button class="plus-btn"><svg src="./assets/icons/plus.svg" alt="+"></svg></button>\n            </div>\n        </div>\n    ')}function de(e,t){t.is_checked||e.querySelector(".item-details").addEventListener("click",()=>{Po(e,t)})}function Ao(e,t){const n=e.querySelector(".item-details");if(n){const s=n.cloneNode(!0);n.parentNode.replaceChild(s,n)}}function Po(e,t){if(!Rt()){const n=e.cloneNode(!0),s=Ut();qo(e),e.innerHTML=s,Ot(),Mo(e,t);const o=e.querySelector(".save-btn"),i=e.querySelector(".cancel-btn");o.addEventListener("click",()=>{$o(e,n,t)}),i.addEventListener("click",()=>{e.replaceWith(n),Pe(n,t),de(n,t),j()})}}function qo(e){e.id="newItem";const t="grocery-item drop-shadow addingContainer";e.className=t}function Mo(e,t){const n=e.querySelector("#new-item-container");n.querySelector('input[type="text"]').value=t.name||"",n.querySelector('input[type="number"]').value=Math.round(t.amount)||"";const s=n.querySelectorAll(".custom-select");s[0].querySelector(".select-text").textContent=t.category||"Protein",s[1].querySelector(".select-text").textContent=Mt(t.unit_of_measurement)||"g"}function $o(e,t,n){const s=Ft();if(!Nt(s))return;const o={...s.item,is_checked:0};Ce(qe(n),o),Oo(e,t,o)}function Oo(e,t,n){Uo(e,t),e.innerHTML=Pt(n),de(e,n),Pe(e,n),_t(),H(e,".grocery-item",Tt)}function Uo(e,t){e.id=t.id||"",e.className=t.className||"grocery-item drop-shadow"}function No(e,t,n,s){return e.dataset.locked==="true"?(n.preventDefault(),t.checked=!0,!0):(e.dataset.locked="true",setTimeout(()=>{delete e.dataset.locked},s),!1)}function Fo(e){delete e.dataset.locked}async function Pe(e,t){const n=e.querySelector(".checkbox-gl");n.addEventListener("change",s=>Ho(s,e,t,n))}async function Ho(e,t,n,s){if(No(t,s,e,600))return;const i={ingredient_id:n.ingredient_id||null,custom_name:n.name||null,category:n.category||null,amount:n.amount,unit_of_measurement:n.unit_of_measurement,is_checked:s.checked?1:0};j(),await Ro(t,i.is_checked,600,n),await Ce(qe(n),i),Fo(t)}async function Ro(e,t,n,s){const o=document.querySelector(".grocery-list");t?(Ao(e),qt(e),be(),await new Promise(i=>setTimeout(i,n)),o.appendChild(e)):(de(e,s),jo(e),be(),o.insertBefore(e,o.firstChild))}function qt(e){const t=e.querySelector(".quantity-control");t&&(t.style.display="none")}function jo(e){const t=e.querySelector(".quantity-control");t&&(t.style.display="flex")}function qe(e){if(e.ingredient_id!==null&&e.ingredient_id!==void 0)return e.ingredient_id;if(e.name)return e.name;console.error("Item has no valid identifier")}function Mt(e){return e==="piece"?"pcs":e}function $t(e){return e==="pcs"?"piece":e}function Ot(){newItem.querySelectorAll(".custom-select").forEach(t=>{new Q(t)})}function Wo(e="grocery-item drop-shadow"){const t=document.querySelector(".grocery-list"),n=document.createElement("li");n.id="newItem",n.className=e,n.innerHTML=Ut(),t.insertBefore(n,t.firstChild),Ot();const s=n.querySelector(".save-btn"),o=n.querySelector(".cancel-btn");s.addEventListener("click",Go),o.addEventListener("click",Ht)}function Ut(){return'\n    <div id="new-item-container">\n        <div class="item-details-add">\n            <input id="name-gl" type="text" placeholder="Item Name" />\n            <div class="custom-select">\n                <div class="select-trigger">\n                    <span class="select-text">Protein</span>\n                    <div class="select-arrow"></div>\n                </div>\n                <div class="select-dropdown">\n                    <div class="select-option" data-value="Protein">Protein</div>\n                    <div class="select-option" data-value="Fruit">Fruit</div>\n                    <div class="select-option" data-value="Dairy">Dairy</div>\n                </div>\n            </div>\n        </div>\n        <div class="quantity-control-add">\n            <input id="number-gl" type="number" placeholder="100" />\n            <div class="custom-select unit-gl">\n                <div class="select-trigger">\n                    <span class="select-text">Select Unit</span>\n                    <div class="select-arrow"></div>\n                </div>\n                <div class="select-dropdown">\n                    <div class="select-option" data-value="g">g</div>\n                    <div class="select-option" data-value="pcs">pcs</div>\n                    <div class="select-option" data-value="ml">ml</div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="buttons-container">\n        <button class="cancel-btn">Cancel</button>\n        <button class="save-btn">Save</button>\n    </div>\n    '}function Go(){const e=Ft();if(!Nt(e))return;At(e.item);const t=Ko(e.item);mn(t),Ht(),j()}function Nt(e){return e.allFieldsFilled?e.isValidName?e.isUniqueName?!0:(alert("An item with this name already exists."),!1):(alert("Please enter a valid name!\n(Name must not be empty, only numbers, or start with a number)"),!1):(alert("Please fill out all fields!"),!1)}function Ft(){const e=document.getElementById("new-item-container"),t=e.querySelector('input[type="text"]').value.trim(),n=parseInt(e.querySelector('input[type="number"]').value,10),s=e.querySelectorAll(".custom-select"),o=s[0].querySelector(".select-text").textContent,i=s[1].querySelector(".select-text").textContent,r=o,a=$t(i),l=t.length>0&&!/^\d+$/.test(t)&&!/^\d/.test(t),d=!!(t&&n&&r&&a),c=Vo();return{allFieldsFilled:d,isValidName:l,isUniqueName:c,name:t,amount:n,category:r,unit:a,item:{ingredient_id:null,name:t,custom_name:t,category:r,amount:n,unit_of_measurement:a,is_checked:0}}}function Vo(){return!0}function Ko(e){return{custom_name:e.name,category:e.category,amount:e.amount,unit_of_measurement:e.unit_of_measurement}}function Ht(){const e=document.getElementById("newItem");e&&e.remove()}function zo(e){if(e.target.closest(".swipe-delete"))return;const t=e.target.closest("button");if(!t||!t.closest(".quantity-control"))return;e.preventDefault();const n=t.closest(".swipe-content"),s=n.querySelector(".amount");if(!s)return;let o=parseInt(s.textContent,10);t.classList.contains("plus-btn")?s.textContent=o+1:t.classList.contains("minus-btn")&&o>1&&(s.textContent=o-1);const i=n.querySelector(".item-id").textContent;console.warn("IDENTIFIER: "+i);const r=Yo(n,i),a=Xo(i);Jo(a,i,r)}function Yo(e,t){return{ingredient_id:isNaN(t)?null:t,custom_name:isNaN(t)?t:null,category:e.querySelector(".category").textContent,amount:parseInt(e.querySelector(".amount").textContent,10),unit_of_measurement:$t(e.querySelector(".unit").textContent),is_checked:e.querySelector(".checkbox-gl").checked?1:0}}function Xo(e){return typeof e=="number"?"id_".concat(e):"name_".concat(e)}function Jo(e,t,n){X.has(e)&&clearTimeout(X.get(e));const s=setTimeout(()=>{Ce(t,n),X.delete(e)},1e3);X.set(e,s)}function Zo(e){document.querySelectorAll("#filter-bar button").forEach(n=>{n===e?(Qo(e),n.classList.add("active"),n.classList.remove("notActive")):(n.classList.remove("active"),n.classList.add("notActive"))})}function Rt(){return document.getElementById("newItem")!==null}function Qo(e){const t=e.textContent.trim(),n=Rt();document.querySelectorAll(".grocery-list li").forEach((s,o)=>{if(o===0&&n){s.style.display="";return}const i=s.querySelector(".category").textContent.trim();s.style.display=t==="All"||i.includes(t)?"":"none"})}async function ei(){await Gt(["admin","cook","user"]),await Oe()?console.log("[TokenCheck] ✅ Alles in Ordnung"):console.warn("[TokenCheck] ❌ Tokenprüfung fehlgeschlagen – Nutzer wird ausgeloggt"),setInterval(async()=>{console.log("[TokenCheck] 🔄 Starte regelmäßige Prüfung..."),await Oe()?console.log("[TokenCheck] ✅ Alles in Ordnung"):console.warn("[TokenCheck] ❌ Tokenprüfung fehlgeschlagen – Nutzer wird ausgeloggt")},300*1e3),cn(),ni()}ei();const ti={home:Et,list:Co,plan:Ds,meals:Nn,settings:Tn};function ni(){le(),xe(),Me()}let jt=localStorage.getItem("lastValidHash")||"#home";function si(){const e=window.location.hash;e!=="#settings"&&(jt=e,localStorage.setItem("lastValidHash",e))}function oi(){return localStorage.getItem("lastValidHash")||jt||"#home"}function ii(){const e=document.querySelectorAll("#main-nav a");function t(){const n=window.location.hash;e.forEach(s=>{s.getAttribute("href")===n?s.classList.add("active"):s.classList.remove("active")})}t(),window.addEventListener("hashchange",t)}async function Me(){(!window.location.hash||window.location.hash==="")&&window.history.replaceState(null,null,"#home");const e=window.location.hash.slice(1),t=Et;await(ti[e]||t)(),ii(),e!=="settings"&&W(),si(),console.log("Page loaded:",e||"home")}window.addEventListener("hashchange",Me);window.addEventListener("load",Me);function W(){const e=document.getElementById("main-nav");e&&(e.classList.add("showNav"),e.classList.remove("hiddenNav"))}function S(){document.getElementById("navOverlay").classList.add("hidden")}function $e(){document.getElementById("navOverlay").classList.remove("hidden")}export{Re as I,je as N,tt as W,ri as __vite_legacy_guard};
